Step 2 of the two-step algorithm 
